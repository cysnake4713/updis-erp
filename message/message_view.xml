<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
		<menuitem name="Message Management" id="base.menu_main_message" sequence="120"/>
		<menuitem name="Message" parent="base.menu_main_message" id="message" sequence="40"/>
		<record id="action_messages" model="ir.actions.act_window">
			<field name="name">Messages</field>
			<field name="res_model">message.message</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
		</record>
		<record id="action_message_categories" model="ir.actions.act_window">
			<field name="name">Message categories</field>
			<field name="res_model">message.category</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
		</record>
		<menuitem name="Messages" id="message_message" parent="message" action="action_messages"/>
		<menuitem name="Message categories" id="message_category" parent="message" action="action_message_categories"/>
		<record id="form_message_message" model="ir.ui.view">
			<field name="name">form.message.message</field>
			<field name="model">message.message</field>
			<field name="arch" type="xml">
				<form string="Message" version="7.0">
					<h1><field name="name" placeholder="消息标题"/></h1>
					<div class="oe_document_page">
						<field name="meta_display"/>
					</div>
					<group>
						<group col="4">
							<field name="is_allow_send_sms" invisible="1"/>
							<field name="is_allow_sms_receiver" invisible="1"/>
							<field name="category_id" on_change="onchange_category(category_id)"/>
							<field name="sequence"/>
							<field name="is_display_name"/>
							<field name="fbbm"/>
							<field name="read_times" readonly="1"/>
							<field name="expire_date"/>
							<field name="name_for_display"/>
						</group>
					</group>
					<group attrs="{'invisible':[('is_allow_send_sms','=',False)]}">
						<group>
							<div>
								<label for="sms"/>
								<field name="sms"/>
								<label for="sms_receiver_ids" attrs="{'invisible':[('is_allow_sms_receiver','=',False)]}"/>
								<field name="sms_receiver_ids" attrs="{'invisible':[('is_allow_sms_receiver','=',False)]}">
									<tree editable="bottom" string="SMS Receivers">
										<field name="name"/>
										<field name="phone"/>
									</tree>
								</field>
							</div>
						</group>
					</group>
					<field name="content" widget="html" /> 
					<div class="oe_chatter">
						<!--<field name="message_follower_ids" widget="mail_followers" help="Follow this project to automatically follow all related update and comments."/>-->
						<field name="message_ids" widget="mail_thread"/>
					</div>
				</form>
			</field>
		</record>
		<record id="tree_message_message" model="ir.ui.view">
			<field name="name">tree.message.message</field>
			<field name="model">message.message</field>
			<field name="arch" type="xml">
				<tree string="Message">
					<field name="name"/>
					<field name="category_id"/>
					<field name="fbbm"/>
					<field name="read_times"/>
					<field name="name_for_display"/>
				</tree>
			</field>
		</record>

		<record id="form_message_category" model="ir.ui.view">
			<field name="name">form.message.category</field>
			<field name="model">message.category</field>
			<field name="arch" type="xml">
				<form string="Message Category" version="7.0">
					<h1><field name="name" placeholder="消息分类名称"/></h1>
					<group>
						<group col="4">
							<field name="is_anonymous_allowed"/>
							<field name="display_position"/> 
							<field name="meta"/> 
							<newline/>
							<field name="is_allow_send_sms" on_change="onchange_is_allow_send_sms(is_allow_send_sms)" />
						</group>
					</group>
					<group attrs="{'invisible':[('is_allow_send_sms','=',False)]}">
						<div>
							<field name="is_allow_sms_receiver" nolabel="1"/>
							<label for="is_allow_sms_receiver"/>
							<separator colspan="2" />
							<label for="default_sms_receiver_ids"/>
							<field name="default_sms_receiver_ids" nolabel="1">
								<tree editable="bottom" string="SMS Receivers">
									<field name="name" string="人员"/>
									<field name="phone"/>
								</tree>
							</field>
						</div>
					</group>
					<label for="display_in_departments" string="在以下部门显示"/>
					<field name="display_in_departments" >
						<tree string="部门">
							<field name="name"/>
						</tree>
					</field>
				</form>
			</field>
		</record>
		<record id="tree_message_category" model="ir.ui.view">
			<field name="name">tree.message.category</field>
			<field name="model">message.category</field>
			<field name="arch" type="xml">
				<tree string="Message Category" version="7.0">
					<field name="name"/>
					<field name="is_anonymous_allowed"/>
					<field name="display_position"/>
				</tree>
			</field>
		</record>
		<record id="search_message_message" model="ir.ui.view">
			<field name="name">search.message.message</field>
			<field name="model">message.message</field>
			<field name="arch" type="xml">
				<search string="Message Filter">
					<group expand="0" string="Group by...">
						<filter string="Category" domain="[]" context="{'group_by':'category_id'}"/>
						<filter string="Publisher" domain="[]" context="{'group_by':'fbbm'}"/>
					</group>
				</search>
			</field>
		</record>
	</data>
</openerp>
