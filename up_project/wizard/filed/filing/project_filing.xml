<?xml version="1.0" encoding="utf-8" ?>
<openerp>
    <data>
        <!--project.project.filed.filing.attachment.analysis-->
        <record id="view_project_filing_attach_analysis_tree" model="ir.ui.view">
            <field name="name">project.project.filed.filing.attachment.analysis.tree</field>
            <field name="model">project.project.filed.filing.attachment.analysis</field>
            <field name="arch" type="xml">
                <tree string="Filing Attachments Analysis" version="7.0" edit="false" create="false" delete="false">
                    <field name="attachment_id"/>
                    <field name="parent_id"/>
                    <field name="create_date"/>
                    <field name="create_uid"/>
                    <field name="version"/>
                </tree>
            </field>
        </record>
        <!--project.project.filed.tag-->
        <record id="view_project_filed_filling_tag_tree" model="ir.ui.view">
            <field name="name">project.project.filed.tag.tree</field>
            <field name="model">project.project.filed.tag</field>
            <field name="arch" type="xml">
                <tree string="Project Tags" version="7.0" editable="top">
                    <field name="name"/>
                    <field name="parent_id"/>
                </tree>
            </field>
        </record>
        <!--project.project.filed.filing-->
        <record id="view_project_filed_filing_tree" model="ir.ui.view">
            <field name="name">project.project.filed.filing.tree</field>
            <field name="model">project.project.filed.filing</field>
            <field name="arch" type="xml">
                <tree string="Project Filing Histories" version="7.0" create="false" delete="false" edit="false"
                      colors="red:state=='approve_filing';grey:state=='end_filing'">
                    <field name="name"/>
                    <field name="state"/>
                    <field name="create_date"/>
                    <field name="create_uid"/>
                    <field name="write_date"/>
                    <field name="write_uid"/>
                    <field name="version"/>
                </tree>
            </field>
        </record>

        <record id="view_project_filed_filing_form" model="ir.ui.view">
            <field name="name">project.project.filed.filing.form</field>
            <field name="model">project.project.filed.filing</field>
            <field name="arch" type="xml">
                <form string="Project Filing" version="7.0" create="false" delete="false">
                    <header>
                        <button name="button_apply_filing" type="object" string="Apply Filing" class="oe_highlight" states="apply_filing"/>
                        <button name="button_approve_filing" type="object" string="Approve Filing" class="oe_highlight" states="approve_filing"/>
                        <button name="button_disapprove_filing" type="object" string="Dispprove Filing" states="approve_filing"/>
                        <field name="state" widget="statusbar" readonly="1"/>
                    </header>
                    <sheet>

                        <div class="sheet-title">
                            <h1>项目文件归档表</h1>
                        </div>
                        <group>
                            <group string="Project Info">
                                <group colspan="2">
                                    <field name="project_id" readonly="1"/>
                                </group>
                                <group>
                                    <field name="project_user" widget="many2many_tags"/>
                                    <field name="project_category_id"/>
                                    <field name="project_second_category"/>
                                    <field name="end_stage"/>
                                </group>
                                <group>
                                    <field name="project_serial_number"/>
                                    <field name="project_scale"/>
                                    <label string="Project Location" for="country_id"/>
                                    <div class="address_format">
                                        <field name="project_country_id" class="oe_no_button" nolabel="1" style="width: 20%%"/>
                                        <field name="project_state_id" widget="selection" options="{'no_open':True}"
                                               placeholder="State" nolabel="1" style="width: 20%%"/>
                                        <field name="project_city" nolabel="1" style="width: 20%%"/>
                                    </div>
                                </group>
                            </group>
                            <group string="Paper Filing Info" colspan="2" col="4">
                                <label for="project_begin_date" string="Project Period"/>
                                <div>
                                    <field name="project_begin_date" nolabel="1" style="width: 20%%"/>
                                    至
                                    <field name="project_end_date" nolabel="1" style="width: 20%%"/>
                                </div>
                                <newline/>
                                <field name="tag_ids" widget="many2many_tags" domain="[('parent_id','!=',None)]"/>
                            </group>
                            <group colspan="2">
                                <field name="description" widget="html"/>
                                <field name="note" widget="html"/>
                                <field name="show_images" widget="many2many_binary"
                                       res_model="project.project" res_id="project_id"
                                       context="{'parent_id':%(dir_up_project_going_brief_picture)d}"/>
                            </group>
                            <group colspan="2" col="1">
                                <label for="record_ids"/>
                                <field name="record_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="type_id"/>
                                        <field name="name"/>
                                        <field name="copy_count"
                                               attrs="{'readonly':[('type_id','in',[%(project_filed_type_0001)d,%(project_filed_type_0004)d],False)]}"/>
                                        <field name="page_count"/>
                                        <field name="document_number"/>
                                        <field name="comment"/>
                                    </tree>
                                </field>
                            </group>
                            <group string="Elec Document Filing Info" colspan="2" col="1">
                                <button name="button_show_filing_update_list" class="oe_left oe_highlight"
                                        string="点此添加电子文件到目录"
                                        type="object" states="apply_filing"/>
                                <label for="attachment_ids" string="Need Filing Elec Attachments"/>
                                <field name="attachment_ids" nolabel="1"
                                       domain="[('res_model', '=', 'project.project'),('res_id', '=', project_id),('parent_id','child_of',%(up_project.dir_up_project_going)d)]"/>
                                <button name="button_show_filing_attachment_analysis" class="oe_left"
                                        string="查看历史记录"
                                        type="object"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
    </data>
</openerp>