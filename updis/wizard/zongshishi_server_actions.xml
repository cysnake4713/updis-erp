<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
		<!-- 邮件 -->
		<record id="zongshishishenpi_send_email" model="ir.actions.server">
			<field name="name">发送总师室审批提醒邮件</field>
			<field name="condition">object.send_email</field>
			<field name="state">email</field>
			<field name="model_id" ref="updis.model_project_review_zongshishishenpi_form"></field>
			<field name="email">object.reviewer_id.email</field>
			<field name="subject">请审批[[object.submitter_id.name]]提交的项目[[object.project_id.name]]</field>
			<field name="message"><![CDATA[
尊敬的[[object.reviewer_id.name]]总师室:
[[object.submitter_id.name]]于[[object.create_date]]提交了项目<strong>[[object.project_id.name]]</strong>任务下达申请单，
请审批[[object.submitter_id.name]]提交的项目[[object.project_id.name]]
审批地址是：
<a href="">现在去审批</a>
				 ]]></field>
		</record>
		<!-- 短信 -->
		<record id="zongshishishenpi_send_sms" model="ir.actions.server">
			<field name="name">发送总师室审批提醒短信</field>
			<field name="condition">object.send_sms</field>
			<field name="state">object_create</field>
			<field name="model_id" ref="updis.model_project_review_zongshishishenpi_form"></field>
			<field name="srcmodel_id" ref="sms.model_sms_sms"></field>			
		</record>
		<record id="lines_zongshishi_content" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_send_sms" />
			<field name="col1" ref="sms.field_sms_sms_content" />
			<field name="type">equation</field>
			<field name="value">u"%s于%s提交了项目%s"%(object.submitter_id.name,object.create_date,object.project_id.name)</field>
		</record>
		<record id="lines_zongshishi_to" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_send_sms" />
			<field name="col1" ref="sms.field_sms_sms_to" />
			<field name="type">equation</field>
			<field name="value">object.reviewer_id.mobile</field>
		</record>
		<record id="lines_zongshishi_from" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_send_sms" />
			<field name="col1" ref="sms.field_sms_sms_from" />
			<field name="type">equation</field>
			<field name="value">object.submitter_id.mobile</field>
		</record>
		<record id="lines_zongshishi_res_id" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_send_sms" />
			<field name="col1" ref="sms.field_sms_sms_res_id" />
			<field name="type">equation</field>
			<field name="value">object.id</field>
		</record>
		<record id="lines_zongshishi_model" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_send_sms" />
			<field name="col1" ref="sms.field_sms_sms_model" />
			<field name="type">value</field>
			<field name="value">project.review.zongshishishenpi.form</field>
		</record>
		<!-- 更新项目 -->
		<record id="zongshishishenpi_update_project" model="ir.actions.server">
			<field name="name">更新总师室审批内容到项目</field>
			<field name="condition">True</field>
			<field name="state">object_write</field>			
			<field name="model_id" ref="updis.model_project_review_zongshishishenpi_form"></field>
			<field name="srcmodel_id" ref="project.model_project_project"></field>
			<field name="write_id">object.project_id</field>
		</record>
		<!-- 总师室审批单 -->
		<!-- <record id="lines_zongshishi_xiangmubianhao" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_update_project" />
			<field name="col1" ref="updis.field_project_project_categories_id" />
			<field name="type">equation</field>
			<field name="value">object.categories_id</field>
		</record> -->
		<record id="lines_zongshishi_pingshenfangshi" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_update_project" />
			<field name="col1" ref="updis.field_project_project_toubiaoleibie" />
			<field name="type">equation</field>
			<field name="value">object.toubiaoleibie</field>
		</record>
		<record id="lines_zongshishi_yinfacuoshi" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_update_project" />
			<field name="col1" ref="updis.field_project_project_guanlijibie" />
			<field name="type">equation</field>
			<field name="value">object.guanlijibie</field>
		</record>
		<record id="lines_zongshishi_renwuyaoqiu" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_update_project" />
			<field name="col1" ref="updis.field_project_project_chenjiefuzeren_id" />
			<field name="type">equation</field>
			<field name="value">object.chenjiefuzeren_id</field>
		</record>
		<record id="lines_zongshishi_chenjiebumen_id" model="ir.server.object.lines">
			<field name="server_id" ref="zongshishishenpi_update_project" />
			<field name="col1" ref="updis.field_project_project_zhuguanzongshi_id" />
			<field name="type">equation</field>
			<field name="value">object.zhuguanzongshi_id</field>
		</record>
		<!-- 更新项目分类 -->
		<record id="zongshishishenpi_update_project_categories" model="ir.actions.server">
			<field name="name">更新总师室审批内容之项目分类到项目</field>			
			<field name="state">code</field>			
			<field name="model_id" ref="updis.model_project_review_zongshishishenpi_form"></field>			
			<field name="code">self.update_project_categories(cr,uid,context.get('active_ids', []),context=context)</field>
		</record>

		<!-- 处理审批通过 -->
		<record id="zongshishishenpi_multi_submitted" model="ir.actions.server">
			<field name="name">处理提交总师室</field>
			<field name="condition">True</field>
			<field name="state">other</field>
			<field name="model_id" ref="updis.model_project_review_zongshishishenpi_form"></field>
			<field name="child_ids" eval="[(6,0,[ref('zongshishishenpi_send_email'),ref('zongshishishenpi_send_sms')])]"></field>
		</record>
		<record id="zongshishishenpi_multi_accepted" model="ir.actions.server">
			<field name="name">处理总师室审批通过</field>
			<field name="condition">True</field>
			<field name="state">other</field>
			<field name="model_id" ref="updis.model_project_review_zongshishishenpi_form"></field>
			<field name="child_ids" eval="[(6,0,[ref('zongshishishenpi_update_project'),ref('zongshishishenpi_update_project_categories')])]"></field>
		</record>
	</data>
</openerp>